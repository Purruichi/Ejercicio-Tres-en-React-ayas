{"ast":null,"code":"import{useState,useEffect}from\"react\";import{getBoard,reloadBoard,createGame,getWinner,turno,joinGame,leaveGame,getInGame,resetGame}from\"./Api\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function Board(){const[xIsNext,setXIsNext]=useState(true);const[squares,setSquares]=useState(getBoard()||Array(9).fill(null));const[winner,setWinner]=useState(null);const[isPolling,setIsPolling]=useState(true);useEffect(()=>{if(!isPolling)return;const interval=setInterval(()=>{reloadBoard().then(()=>{const newBoard=getBoard();if(JSON.stringify(squares)!==JSON.stringify(newBoard)){setSquares(newBoard||Array(9).fill(null));setIsPolling(false);const currentWinner=getWinner();if(currentWinner){setWinner(currentWinner);setIsPolling(false);}}});},5000);return()=>clearInterval(interval);},[squares,isPolling]);function handleClick(i){if(squares[i]||winner)return;turno(i).then(()=>{setSquares(getBoard()||Array(9).fill(\"Err\"));setWinner(getWinner());setXIsNext(!xIsNext);setIsPolling(true);});}function handleNewGame(){createGame();setSquares(getBoard()||Array(9).fill(null));setWinner(null);setIsPolling(true);}function handleLeaveGame(){leaveGame().then(()=>{setSquares(Array(9).fill(null));setWinner(null);setIsPolling(false);}).catch(error=>{console.error(\"Error al salir del juego:\",error);});}function handleResetGame(){resetGame().then(()=>{setSquares(Array(9).fill(null));setWinner(null);setIsPolling(true);}).catch(error=>{console.error(\"Error al reiniciar el juego:\",error);});}function handleJoinGame(){joinGame().then(()=>{console.log(\"Unido al juego\");setSquares(getBoard()||Array(9).fill(null));setWinner(null);setIsPolling(true);}).catch(error=>{console.error(\"Error al unirse al juego:\",error);});}useEffect(()=>{const newGameButton=document.getElementById(\"newGame\");const joinGameButton=document.getElementById(\"joinGame\");const leaveGameButton=document.getElementById(\"leaveGame\");const resetGameButton=document.getElementById(\"resetGame\");if(newGameButton){newGameButton.addEventListener(\"click\",handleNewGame);}if(joinGameButton){joinGameButton.addEventListener(\"click\",handleJoinGame);}if(leaveGameButton){leaveGameButton.addEventListener(\"click\",handleLeaveGame);}if(resetGameButton){resetGameButton.addEventListener(\"click\",handleResetGame);}return()=>{if(newGameButton){newGameButton.removeEventListener(\"click\",handleNewGame);}if(joinGameButton){joinGameButton.removeEventListener(\"click\",handleJoinGame);}if(leaveGameButton){leaveGameButton.removeEventListener(\"click\",handleLeaveGame);}if(resetGameButton){resetGameButton.removeEventListener(\"click\",handleResetGame);}};},[]);let status;if(getInGame()===false){status=\"No estás en un juego.\";}else{status=winner?`Ganador: ${winner}!`:`Siguiente jugador: ${xIsNext?\"X\":\"O\"}`;}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"status\",children:status}),/*#__PURE__*/_jsxs(\"div\",{className:\"board-row\",children:[/*#__PURE__*/_jsx(Square,{value:squares[0],onSquareClick:()=>handleClick(0)}),/*#__PURE__*/_jsx(Square,{value:squares[1],onSquareClick:()=>handleClick(1)}),/*#__PURE__*/_jsx(Square,{value:squares[2],onSquareClick:()=>handleClick(2)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"board-row\",children:[/*#__PURE__*/_jsx(Square,{value:squares[3],onSquareClick:()=>handleClick(3)}),/*#__PURE__*/_jsx(Square,{value:squares[4],onSquareClick:()=>handleClick(4)}),/*#__PURE__*/_jsx(Square,{value:squares[5],onSquareClick:()=>handleClick(5)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"board-row\",children:[/*#__PURE__*/_jsx(Square,{value:squares[6],onSquareClick:()=>handleClick(6)}),/*#__PURE__*/_jsx(Square,{value:squares[7],onSquareClick:()=>handleClick(7)}),/*#__PURE__*/_jsx(Square,{value:squares[8],onSquareClick:()=>handleClick(8)})]})]});}function Square(_ref){let{value,onSquareClick}=_ref;return/*#__PURE__*/_jsx(\"button\",{className:\"square\",onClick:onSquareClick,children:value});}","map":{"version":3,"names":["useState","useEffect","getBoard","reloadBoard","createGame","getWinner","turno","joinGame","leaveGame","getInGame","resetGame","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Board","xIsNext","setXIsNext","squares","setSquares","Array","fill","winner","setWinner","isPolling","setIsPolling","interval","setInterval","then","newBoard","JSON","stringify","currentWinner","clearInterval","handleClick","i","handleNewGame","handleLeaveGame","catch","error","console","handleResetGame","handleJoinGame","log","newGameButton","document","getElementById","joinGameButton","leaveGameButton","resetGameButton","addEventListener","removeEventListener","status","children","className","Square","value","onSquareClick","_ref","onClick"],"sources":["C:/Users/purru/OneDrive - Universidad Pontificia Comillas/Documentos/3_Tercero/PAT/Repositorios/practica4/Ejercicio Tres en React-ayas/src/App.js"],"sourcesContent":["import { useState, useEffect } from \"react\";\nimport { getBoard, reloadBoard, createGame, getWinner, turno, joinGame, leaveGame, getInGame, resetGame } from \"./Api\";\n\nexport default function Board() {\n  const [xIsNext, setXIsNext] = useState(true);\n  const [squares, setSquares] = useState(getBoard() || Array(9).fill(null));\n  const [winner, setWinner] = useState(null);\n  const [isPolling, setIsPolling] = useState(true);\n\n  useEffect(() => {\n    if (!isPolling) return;\n\n    const interval = setInterval(() => {\n      reloadBoard().then(() => {\n        const newBoard = getBoard();\n        if (JSON.stringify(squares) !== JSON.stringify(newBoard)) {\n          setSquares(newBoard || Array(9).fill(null));\n          setIsPolling(false);\n          \n          const currentWinner = getWinner();\n          if (currentWinner) {\n            setWinner(currentWinner);\n            setIsPolling(false);\n          }\n        }\n      });\n    }, 5000);\n\n    return () => clearInterval(interval);\n  }, [squares, isPolling]);\n\n  function handleClick(i) {\n    if (squares[i] || winner) return;\n\n    turno(i).then(() => {\n      setSquares(getBoard() || Array(9).fill(\"Err\"));\n      setWinner(getWinner());\n      setXIsNext(!xIsNext);\n      setIsPolling(true);\n    });\n  }\n\n  function handleNewGame() {\n    createGame();\n    setSquares(getBoard() || Array(9).fill(null));\n    setWinner(null);\n    setIsPolling(true);\n  }\n\n  function handleLeaveGame() {\n    leaveGame()\n      .then(() => {\n        setSquares(Array(9).fill(null));\n        setWinner(null);\n        setIsPolling(false);\n      })\n      .catch((error) => {\n        console.error(\"Error al salir del juego:\", error);\n      });\n  }\n\n  function handleResetGame() {\n    resetGame()\n      .then(() => {\n        setSquares(Array(9).fill(null));\n        setWinner(null);\n        setIsPolling(true);\n      })\n      .catch((error) => {\n        console.error(\"Error al reiniciar el juego:\", error);\n      });\n  }\n\n  function handleJoinGame() {\n    joinGame()\n      .then(() => {\n        console.log(\"Unido al juego\");\n        setSquares(getBoard() || Array(9).fill(null));\n        setWinner(null);\n        setIsPolling(true);\n      })\n      .catch((error) => {\n        console.error(\"Error al unirse al juego:\", error);\n      });\n  }\n\n  useEffect(() => {\n    const newGameButton = document.getElementById(\"newGame\");\n    const joinGameButton = document.getElementById(\"joinGame\");\n    const leaveGameButton = document.getElementById(\"leaveGame\");\n    const resetGameButton = document.getElementById(\"resetGame\");\n\n    if (newGameButton) {\n      newGameButton.addEventListener(\"click\", handleNewGame);\n    }\n\n    if (joinGameButton) {\n      joinGameButton.addEventListener(\"click\", handleJoinGame);\n    }\n\n    if (leaveGameButton) {\n      leaveGameButton.addEventListener(\"click\", handleLeaveGame);\n    }\n\n    if (resetGameButton) {\n      resetGameButton.addEventListener(\"click\", handleResetGame);\n    }\n\n    return () => {\n      if (newGameButton) {\n        newGameButton.removeEventListener(\"click\", handleNewGame);\n      }\n      if (joinGameButton) {\n        joinGameButton.removeEventListener(\"click\", handleJoinGame);\n      }\n      if (leaveGameButton) {\n        leaveGameButton.removeEventListener(\"click\", handleLeaveGame);\n      }\n      if (resetGameButton) {\n        resetGameButton.removeEventListener(\"click\", handleResetGame);\n      }\n    };\n  }, []);\n\n  let status;\n  if (getInGame() === false) {\n    status = \"No estás en un juego.\";\n  } else {\n    status = winner ? `Ganador: ${winner}!` : `Siguiente jugador: ${xIsNext ? \"X\" : \"O\"}`;\n  }\n\n  return (\n    <>\n      <div className=\"status\">{status}</div>\n      <div className=\"board-row\">\n        <Square value={squares[0]} onSquareClick={() => handleClick(0)} />\n        <Square value={squares[1]} onSquareClick={() => handleClick(1)} />\n        <Square value={squares[2]} onSquareClick={() => handleClick(2)} />\n      </div>\n      <div className=\"board-row\">\n        <Square value={squares[3]} onSquareClick={() => handleClick(3)} />\n        <Square value={squares[4]} onSquareClick={() => handleClick(4)} />\n        <Square value={squares[5]} onSquareClick={() => handleClick(5)} />\n      </div>\n      <div className=\"board-row\">\n        <Square value={squares[6]} onSquareClick={() => handleClick(6)} />\n        <Square value={squares[7]} onSquareClick={() => handleClick(7)} />\n        <Square value={squares[8]} onSquareClick={() => handleClick(8)} />\n      </div>\n    </>\n  );\n}\n\nfunction Square({ value, onSquareClick }) {\n  return (\n    <button className=\"square\" onClick={onSquareClick}>\n      {value}\n    </button>\n  );\n}"],"mappings":"AAAA,OAASA,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAC3C,OAASC,QAAQ,CAAEC,WAAW,CAAEC,UAAU,CAAEC,SAAS,CAAEC,KAAK,CAAEC,QAAQ,CAAEC,SAAS,CAAEC,SAAS,CAAEC,SAAS,KAAQ,OAAO,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,CAAAC,QAAA,IAAAC,SAAA,yBAEvH,cAAe,SAAS,CAAAC,KAAKA,CAAA,CAAG,CAC9B,KAAM,CAACC,OAAO,CAAEC,UAAU,CAAC,CAAGnB,QAAQ,CAAC,IAAI,CAAC,CAC5C,KAAM,CAACoB,OAAO,CAAEC,UAAU,CAAC,CAAGrB,QAAQ,CAACE,QAAQ,CAAC,CAAC,EAAIoB,KAAK,CAAC,CAAC,CAAC,CAACC,IAAI,CAAC,IAAI,CAAC,CAAC,CACzE,KAAM,CAACC,MAAM,CAAEC,SAAS,CAAC,CAAGzB,QAAQ,CAAC,IAAI,CAAC,CAC1C,KAAM,CAAC0B,SAAS,CAAEC,YAAY,CAAC,CAAG3B,QAAQ,CAAC,IAAI,CAAC,CAEhDC,SAAS,CAAC,IAAM,CACd,GAAI,CAACyB,SAAS,CAAE,OAEhB,KAAM,CAAAE,QAAQ,CAAGC,WAAW,CAAC,IAAM,CACjC1B,WAAW,CAAC,CAAC,CAAC2B,IAAI,CAAC,IAAM,CACvB,KAAM,CAAAC,QAAQ,CAAG7B,QAAQ,CAAC,CAAC,CAC3B,GAAI8B,IAAI,CAACC,SAAS,CAACb,OAAO,CAAC,GAAKY,IAAI,CAACC,SAAS,CAACF,QAAQ,CAAC,CAAE,CACxDV,UAAU,CAACU,QAAQ,EAAIT,KAAK,CAAC,CAAC,CAAC,CAACC,IAAI,CAAC,IAAI,CAAC,CAAC,CAC3CI,YAAY,CAAC,KAAK,CAAC,CAEnB,KAAM,CAAAO,aAAa,CAAG7B,SAAS,CAAC,CAAC,CACjC,GAAI6B,aAAa,CAAE,CACjBT,SAAS,CAACS,aAAa,CAAC,CACxBP,YAAY,CAAC,KAAK,CAAC,CACrB,CACF,CACF,CAAC,CAAC,CACJ,CAAC,CAAE,IAAI,CAAC,CAER,MAAO,IAAMQ,aAAa,CAACP,QAAQ,CAAC,CACtC,CAAC,CAAE,CAACR,OAAO,CAAEM,SAAS,CAAC,CAAC,CAExB,QAAS,CAAAU,WAAWA,CAACC,CAAC,CAAE,CACtB,GAAIjB,OAAO,CAACiB,CAAC,CAAC,EAAIb,MAAM,CAAE,OAE1BlB,KAAK,CAAC+B,CAAC,CAAC,CAACP,IAAI,CAAC,IAAM,CAClBT,UAAU,CAACnB,QAAQ,CAAC,CAAC,EAAIoB,KAAK,CAAC,CAAC,CAAC,CAACC,IAAI,CAAC,KAAK,CAAC,CAAC,CAC9CE,SAAS,CAACpB,SAAS,CAAC,CAAC,CAAC,CACtBc,UAAU,CAAC,CAACD,OAAO,CAAC,CACpBS,YAAY,CAAC,IAAI,CAAC,CACpB,CAAC,CAAC,CACJ,CAEA,QAAS,CAAAW,aAAaA,CAAA,CAAG,CACvBlC,UAAU,CAAC,CAAC,CACZiB,UAAU,CAACnB,QAAQ,CAAC,CAAC,EAAIoB,KAAK,CAAC,CAAC,CAAC,CAACC,IAAI,CAAC,IAAI,CAAC,CAAC,CAC7CE,SAAS,CAAC,IAAI,CAAC,CACfE,YAAY,CAAC,IAAI,CAAC,CACpB,CAEA,QAAS,CAAAY,eAAeA,CAAA,CAAG,CACzB/B,SAAS,CAAC,CAAC,CACRsB,IAAI,CAAC,IAAM,CACVT,UAAU,CAACC,KAAK,CAAC,CAAC,CAAC,CAACC,IAAI,CAAC,IAAI,CAAC,CAAC,CAC/BE,SAAS,CAAC,IAAI,CAAC,CACfE,YAAY,CAAC,KAAK,CAAC,CACrB,CAAC,CAAC,CACDa,KAAK,CAAEC,KAAK,EAAK,CAChBC,OAAO,CAACD,KAAK,CAAC,2BAA2B,CAAEA,KAAK,CAAC,CACnD,CAAC,CAAC,CACN,CAEA,QAAS,CAAAE,eAAeA,CAAA,CAAG,CACzBjC,SAAS,CAAC,CAAC,CACRoB,IAAI,CAAC,IAAM,CACVT,UAAU,CAACC,KAAK,CAAC,CAAC,CAAC,CAACC,IAAI,CAAC,IAAI,CAAC,CAAC,CAC/BE,SAAS,CAAC,IAAI,CAAC,CACfE,YAAY,CAAC,IAAI,CAAC,CACpB,CAAC,CAAC,CACDa,KAAK,CAAEC,KAAK,EAAK,CAChBC,OAAO,CAACD,KAAK,CAAC,8BAA8B,CAAEA,KAAK,CAAC,CACtD,CAAC,CAAC,CACN,CAEA,QAAS,CAAAG,cAAcA,CAAA,CAAG,CACxBrC,QAAQ,CAAC,CAAC,CACPuB,IAAI,CAAC,IAAM,CACVY,OAAO,CAACG,GAAG,CAAC,gBAAgB,CAAC,CAC7BxB,UAAU,CAACnB,QAAQ,CAAC,CAAC,EAAIoB,KAAK,CAAC,CAAC,CAAC,CAACC,IAAI,CAAC,IAAI,CAAC,CAAC,CAC7CE,SAAS,CAAC,IAAI,CAAC,CACfE,YAAY,CAAC,IAAI,CAAC,CACpB,CAAC,CAAC,CACDa,KAAK,CAAEC,KAAK,EAAK,CAChBC,OAAO,CAACD,KAAK,CAAC,2BAA2B,CAAEA,KAAK,CAAC,CACnD,CAAC,CAAC,CACN,CAEAxC,SAAS,CAAC,IAAM,CACd,KAAM,CAAA6C,aAAa,CAAGC,QAAQ,CAACC,cAAc,CAAC,SAAS,CAAC,CACxD,KAAM,CAAAC,cAAc,CAAGF,QAAQ,CAACC,cAAc,CAAC,UAAU,CAAC,CAC1D,KAAM,CAAAE,eAAe,CAAGH,QAAQ,CAACC,cAAc,CAAC,WAAW,CAAC,CAC5D,KAAM,CAAAG,eAAe,CAAGJ,QAAQ,CAACC,cAAc,CAAC,WAAW,CAAC,CAE5D,GAAIF,aAAa,CAAE,CACjBA,aAAa,CAACM,gBAAgB,CAAC,OAAO,CAAEd,aAAa,CAAC,CACxD,CAEA,GAAIW,cAAc,CAAE,CAClBA,cAAc,CAACG,gBAAgB,CAAC,OAAO,CAAER,cAAc,CAAC,CAC1D,CAEA,GAAIM,eAAe,CAAE,CACnBA,eAAe,CAACE,gBAAgB,CAAC,OAAO,CAAEb,eAAe,CAAC,CAC5D,CAEA,GAAIY,eAAe,CAAE,CACnBA,eAAe,CAACC,gBAAgB,CAAC,OAAO,CAAET,eAAe,CAAC,CAC5D,CAEA,MAAO,IAAM,CACX,GAAIG,aAAa,CAAE,CACjBA,aAAa,CAACO,mBAAmB,CAAC,OAAO,CAAEf,aAAa,CAAC,CAC3D,CACA,GAAIW,cAAc,CAAE,CAClBA,cAAc,CAACI,mBAAmB,CAAC,OAAO,CAAET,cAAc,CAAC,CAC7D,CACA,GAAIM,eAAe,CAAE,CACnBA,eAAe,CAACG,mBAAmB,CAAC,OAAO,CAAEd,eAAe,CAAC,CAC/D,CACA,GAAIY,eAAe,CAAE,CACnBA,eAAe,CAACE,mBAAmB,CAAC,OAAO,CAAEV,eAAe,CAAC,CAC/D,CACF,CAAC,CACH,CAAC,CAAE,EAAE,CAAC,CAEN,GAAI,CAAAW,MAAM,CACV,GAAI7C,SAAS,CAAC,CAAC,GAAK,KAAK,CAAE,CACzB6C,MAAM,CAAG,uBAAuB,CAClC,CAAC,IAAM,CACLA,MAAM,CAAG9B,MAAM,CAAG,YAAYA,MAAM,GAAG,CAAG,sBAAsBN,OAAO,CAAG,GAAG,CAAG,GAAG,EAAE,CACvF,CAEA,mBACEJ,KAAA,CAAAE,SAAA,EAAAuC,QAAA,eACE3C,IAAA,QAAK4C,SAAS,CAAC,QAAQ,CAAAD,QAAA,CAAED,MAAM,CAAM,CAAC,cACtCxC,KAAA,QAAK0C,SAAS,CAAC,WAAW,CAAAD,QAAA,eACxB3C,IAAA,CAAC6C,MAAM,EAACC,KAAK,CAAEtC,OAAO,CAAC,CAAC,CAAE,CAACuC,aAAa,CAAEA,CAAA,GAAMvB,WAAW,CAAC,CAAC,CAAE,CAAE,CAAC,cAClExB,IAAA,CAAC6C,MAAM,EAACC,KAAK,CAAEtC,OAAO,CAAC,CAAC,CAAE,CAACuC,aAAa,CAAEA,CAAA,GAAMvB,WAAW,CAAC,CAAC,CAAE,CAAE,CAAC,cAClExB,IAAA,CAAC6C,MAAM,EAACC,KAAK,CAAEtC,OAAO,CAAC,CAAC,CAAE,CAACuC,aAAa,CAAEA,CAAA,GAAMvB,WAAW,CAAC,CAAC,CAAE,CAAE,CAAC,EAC/D,CAAC,cACNtB,KAAA,QAAK0C,SAAS,CAAC,WAAW,CAAAD,QAAA,eACxB3C,IAAA,CAAC6C,MAAM,EAACC,KAAK,CAAEtC,OAAO,CAAC,CAAC,CAAE,CAACuC,aAAa,CAAEA,CAAA,GAAMvB,WAAW,CAAC,CAAC,CAAE,CAAE,CAAC,cAClExB,IAAA,CAAC6C,MAAM,EAACC,KAAK,CAAEtC,OAAO,CAAC,CAAC,CAAE,CAACuC,aAAa,CAAEA,CAAA,GAAMvB,WAAW,CAAC,CAAC,CAAE,CAAE,CAAC,cAClExB,IAAA,CAAC6C,MAAM,EAACC,KAAK,CAAEtC,OAAO,CAAC,CAAC,CAAE,CAACuC,aAAa,CAAEA,CAAA,GAAMvB,WAAW,CAAC,CAAC,CAAE,CAAE,CAAC,EAC/D,CAAC,cACNtB,KAAA,QAAK0C,SAAS,CAAC,WAAW,CAAAD,QAAA,eACxB3C,IAAA,CAAC6C,MAAM,EAACC,KAAK,CAAEtC,OAAO,CAAC,CAAC,CAAE,CAACuC,aAAa,CAAEA,CAAA,GAAMvB,WAAW,CAAC,CAAC,CAAE,CAAE,CAAC,cAClExB,IAAA,CAAC6C,MAAM,EAACC,KAAK,CAAEtC,OAAO,CAAC,CAAC,CAAE,CAACuC,aAAa,CAAEA,CAAA,GAAMvB,WAAW,CAAC,CAAC,CAAE,CAAE,CAAC,cAClExB,IAAA,CAAC6C,MAAM,EAACC,KAAK,CAAEtC,OAAO,CAAC,CAAC,CAAE,CAACuC,aAAa,CAAEA,CAAA,GAAMvB,WAAW,CAAC,CAAC,CAAE,CAAE,CAAC,EAC/D,CAAC,EACN,CAAC,CAEP,CAEA,QAAS,CAAAqB,MAAMA,CAAAG,IAAA,CAA2B,IAA1B,CAAEF,KAAK,CAAEC,aAAc,CAAC,CAAAC,IAAA,CACtC,mBACEhD,IAAA,WAAQ4C,SAAS,CAAC,QAAQ,CAACK,OAAO,CAAEF,aAAc,CAAAJ,QAAA,CAC/CG,KAAK,CACA,CAAC,CAEb","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}